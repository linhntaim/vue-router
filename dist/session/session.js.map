{"version":3,"sources":["../../src/session/session.js"],"names":["Session","storeHandler","accessTime","nextAccessTime","storeHandlerKey","process","env","VUE_APP_SESSION_STORE_HANDLER_KEY","data","sync","action","setJson","getJson","key","value","store","flash","def"],"mappings":"otBAAaA,CAAAA,O,yBACT,kBAAc,+BACV,KAAKC,YAAL,CAAoB,IAApB,CACA,KAAKC,UAAL,CAAkB,CAAlB,CACA,KAAKC,cAAL,CAAsB,CAAtB,CACA,KAAKC,eAAL,CAAuBC,OAAO,CAACC,GAAR,CAAYC,iCAAZ,CACnBF,OAAO,CAACC,GAAR,CAAYC,iCADO,CAC6B,WADpD,CAGA,KAAKC,IAAL,CAAY,EACf,CAED;AACJ;AACA;AACA,O,sDACI,4BAAmBP,YAAnB,CAAiC,CAC7B,KAAKA,YAAL,CAAoBA,YAApB,CACA,MAAO,MAAKQ,IAAL,CAAU,MAAV,CACV,CAED;AACJ;AACA;AACA,O,gCACI,0BAAiBR,YAAjB,CAA+B,CAC3B,KAAKA,YAAL,CAAoBA,YAApB,CACA,MAAO,MAAKQ,IAAL,EACV,CAED;AACJ;AACA;AACA,O,oBACI,eAAoB,IAAfC,CAAAA,MAAe,2DAAN,IAAM,CAChB,GAAI,CAAC,KAAKT,YAAV,CAAwB,MAAO,KAAP,CAExB,GAAIS,MAAM,GAAK,MAAf,CAAuB,CACnB,KAAKT,YAAL,CAAkBU,OAAlB,CAA0B,KAAKP,eAA/B,CAAgD,KAAKI,IAArD,CACH,CAFD,IAEO,CACH,GAAMA,CAAAA,IAAI,CAAG,KAAKP,YAAL,CAAkBW,OAAlB,CAA0B,KAAKR,eAA/B,CAAb,CACA,GAAII,IAAJ,CAAU,KAAKA,IAAL,CAAYA,IACzB,CACD,MAAO,KACV,C,qBAED,gBAAQ,CACJ,KAAKL,cAAL,CAAsB,EAAE,KAAKD,UAAP,CAAoB,CAA1C,CACA,MAAO,KACV,C,uBAED,kBAAU,CACN,KAAKA,UAAL,CAAkB,CAAlB,CACA,KAAKC,cAAL,CAAsB,CAAtB,CACA,MAAO,KACV,C,oBAED,eAAO,CACH,KAAKA,cAAL,CAAsB,KAAKD,UAA3B,CACA,MAAO,KACV,C,6BAED,wBAAgB,CACZ,KAAKC,cAAL,CAAsB,KAAKD,UAAL,CAAkB,CAAxC,CACA,MAAO,KACV,C,wBAED,mBAAW,CACP,MAAO,MAAKC,cAAL,EAAuB,KAAKD,UACtC,C,uBAED,kBAAU,CACN,MAAO,MAAKA,UAAL,GAAoB,CAC9B,C,0BAED,qBAAa,CACT,MAAO,MAAKA,UAAL,CAAkB,CAC5B,C,qBAED,eAAMW,GAAN,CAAWC,KAAX,CAAkB,CACd,MAAO,MAAKC,KAAL,CAAWF,GAAX,CAAgBC,KAAhB,CAAuB,IAAvB,CACV,C,qBAED,eAAMD,GAAN,CAAWC,KAAX,CAAiC,IAAfE,CAAAA,KAAe,2DAAP,KAAO,CAC7B,KAAKR,IAAL,CAAUK,GAAV,EAAiB,CACbC,KAAK,CAAEA,KADM,CAEbE,KAAK,CAAEA,KAFM,CAAjB,CAIA,MAAO,MAAKP,IAAL,CAAU,MAAV,CACV,C,wBAED,kBAASI,GAAT,CAA0B,IAAZI,CAAAA,GAAY,2DAAN,IAAM,CACtB,GAAI,EAAEJ,GAAG,GAAI,MAAKL,IAAd,CAAJ,CAAyB,MAAOS,CAAAA,GAAP,CAEzB,GAAMT,CAAAA,IAAI,CAAG,KAAKA,IAAL,CAAUK,GAAV,CAAb,CACA,GAAIL,IAAI,CAACQ,KAAT,CAAgB,CACZ,MAAO,MAAKR,IAAL,CAAUK,GAAV,CACV,CACD,MAAOL,CAAAA,IAAI,CAACM,KACf,C,sBAED,gBAAOD,GAAP,CAAY,CACR,MAAO,MAAKL,IAAL,CAAUK,GAAV,CAAP,CACA,MAAO,MAAKJ,IAAL,CAAU,MAAV,CACV,C","sourcesContent":["export class Session {\r\n    constructor() {\r\n        this.storeHandler = null\r\n        this.accessTime = 0\r\n        this.nextAccessTime = 1\r\n        this.storeHandlerKey = process.env.VUE_APP_SESSION_STORE_HANDLER_KEY ?\r\n            process.env.VUE_APP_SESSION_STORE_HANDLER_KEY : '__session'\r\n\r\n        this.data = {}\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {StoreHandler} storeHandler\r\n     */\r\n    attachStoreHandler(storeHandler) {\r\n        this.storeHandler = storeHandler\r\n        return this.sync('save')\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {StoreHandler} storeHandler\r\n     */\r\n    fromStoreHandler(storeHandler) {\r\n        this.storeHandler = storeHandler\r\n        return this.sync()\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String|null} action\r\n     */\r\n    sync(action = null) {\r\n        if (!this.storeHandler) return this\r\n\r\n        if (action === 'save') {\r\n            this.storeHandler.setJson(this.storeHandlerKey, this.data)\r\n        } else {\r\n            const data = this.storeHandler.getJson(this.storeHandlerKey)\r\n            if (data) this.data = data\r\n        }\r\n        return this\r\n    }\r\n\r\n    start() {\r\n        this.nextAccessTime = ++this.accessTime + 1\r\n        return this\r\n    }\r\n\r\n    restart() {\r\n        this.accessTime = 1\r\n        this.nextAccessTime = 2\r\n        return this\r\n    }\r\n\r\n    skip() {\r\n        this.nextAccessTime = this.accessTime\r\n        return this\r\n    }\r\n\r\n    abortSkipping() {\r\n        this.nextAccessTime = this.accessTime + 1\r\n        return this\r\n    }\r\n\r\n    skipping() {\r\n        return this.nextAccessTime <= this.accessTime\r\n    }\r\n\r\n    isFresh() {\r\n        return this.accessTime === 1\r\n    }\r\n\r\n    isNotFresh() {\r\n        return this.accessTime > 1\r\n    }\r\n\r\n    flash(key, value) {\r\n        return this.store(key, value, true)\r\n    }\r\n\r\n    store(key, value, flash = false) {\r\n        this.data[key] = {\r\n            value: value,\r\n            flash: flash,\r\n        }\r\n        return this.sync('save')\r\n    }\r\n\r\n    retrieve(key, def = null) {\r\n        if (!(key in this.data)) return def\r\n\r\n        const data = this.data[key]\r\n        if (data.flash) {\r\n            delete this.data[key]\r\n        }\r\n        return data.value\r\n    }\r\n\r\n    forgot(key) {\r\n        delete this.data[key]\r\n        return this.sync('save')\r\n    }\r\n}\r\n"],"file":"session.js"}