{"version":3,"sources":["../../src/session/session.js"],"names":["Session","storeHandler","storeHandlerKey","process","env","VUE_APP_SESSION_STORE_HANDLER_KEY","sequenceAccess","nextSequenceAccess","data","syncTo","syncFrom","setJson","getJson","sequenceStart","key","value","store","flash","def","forgot"],"mappings":"otBAAaA,CAAAA,O,yBACT,kBAAc,+BACV,KAAKC,YAAL,CAAoB,IAApB,CACA,KAAKC,eAAL,CAAuBC,OAAO,CAACC,GAAR,CAAYC,iCAAZ,CACnBF,OAAO,CAACC,GAAR,CAAYC,iCADO,CAC6B,WADpD,CAGA,KAAKC,cAAL,CAAsB,CAAtB,CACA,KAAKC,kBAAL,CAA0B,CAA1B,CAEA,KAAKC,IAAL,CAAY,EACf,CAED;AACJ;AACA;AACA,O,kDACI,wBAAeP,YAAf,CAA6B,CACzB,KAAKA,YAAL,CAAoBA,YAApB,CACA,MAAO,MAAKQ,MAAL,EACV,CAED;AACJ;AACA;AACA,O,gCACI,0BAAiBR,YAAjB,CAA+B,CAC3B,KAAKA,YAAL,CAAoBA,YAApB,CACA,MAAO,MAAKS,QAAL,EACV,C,sBAED,iBAAS,CACL,GAAI,KAAKT,YAAT,CAAuB,CACnB,KAAKA,YAAL,CAAkBU,OAAlB,CAA0B,KAAKT,eAA/B,CAAgD,KAAKM,IAArD,CACH,CACD,MAAO,KACV,C,wBAED,mBAAW,CACP,GAAI,KAAKP,YAAT,CAAuB,CACnB,GAAMO,CAAAA,IAAI,CAAG,KAAKP,YAAL,CAAkBW,OAAlB,CAA0B,KAAKV,eAA/B,CAAb,CACAM,IAAI,GAAK,KAAKA,IAAL,CAAYA,IAAjB,CACP,CACD,MAAO,KACV,C,qBAED,gBAAQ,CACJ,MAAO,MAAKK,aAAL,EACV,C,6BAED,wBAAgB,CACZ,KAAKN,kBAAL,CAA0B,EAAE,KAAKD,cAAP,CAAwB,CAAlD,CACA,MAAO,KACV,C,+BAED,0BAAkB,CACd,KAAKA,cAAL,CAAsB,CAAtB,CACA,KAAKC,kBAAL,CAA0B,CAA1B,CACA,MAAO,KACV,C,4BAED,uBAAe,CACX,KAAKA,kBAAL,CAA0B,KAAKD,cAA/B,CACA,MAAO,KACV,C,qCAED,gCAAwB,CACpB,KAAKC,kBAAL,CAA0B,KAAKD,cAAL,CAAsB,CAAhD,CACA,MAAO,KACV,C,gCAED,2BAAmB,CACf,MAAO,MAAKC,kBAAL,EAA2B,KAAKD,cAC1C,C,+BAED,0BAAkB,CACd,MAAO,MAAKA,cAAL,GAAwB,CAClC,C,kCAED,6BAAqB,CACjB,MAAO,MAAKA,cAAL,CAAsB,CAChC,C,qBAED,eAAMQ,GAAN,CAAWC,KAAX,CAAkB,CACd,MAAO,MAAKC,KAAL,CAAWF,GAAX,CAAgBC,KAAhB,CAAuB,IAAvB,CACV,C,qBAED,eAAMD,GAAN,CAAWC,KAAX,CAAiC,IAAfE,CAAAA,KAAe,2DAAP,KAAO,CAC7B,KAAKT,IAAL,CAAUM,GAAV,EAAiB,CACbC,KAAK,CAAEA,KADM,CAEbE,KAAK,CAAEA,KAFM,CAAjB,CAIA,MAAO,MAAKR,MAAL,EACV,C,wBAED,kBAASK,GAAT,CAA0B,IAAZI,CAAAA,GAAY,2DAAN,IAAM,CACtB,GAAI,EAAEJ,GAAG,GAAI,MAAKN,IAAd,CAAJ,CAAyB,MAAOU,CAAAA,GAAP,CAEzB,GAAMV,CAAAA,IAAI,CAAG,KAAKA,IAAL,CAAUM,GAAV,CAAb,CACAN,IAAI,CAACS,KAAL,EAAc,KAAKE,MAAL,CAAYL,GAAZ,CAAd,CACA,MAAON,CAAAA,IAAI,CAACO,KACf,C,sBAED,gBAAOD,GAAP,CAAY,CACR,MAAO,MAAKN,IAAL,CAAUM,GAAV,CAAP,CACA,MAAO,MAAKL,MAAL,EACV,C","sourcesContent":["export class Session {\r\n    constructor() {\r\n        this.storeHandler = null\r\n        this.storeHandlerKey = process.env.VUE_APP_SESSION_STORE_HANDLER_KEY ?\r\n            process.env.VUE_APP_SESSION_STORE_HANDLER_KEY : '__session'\r\n\r\n        this.sequenceAccess = 0\r\n        this.nextSequenceAccess = 1\r\n\r\n        this.data = {}\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {StoreHandler} storeHandler\r\n     */\r\n    toStoreHandler(storeHandler) {\r\n        this.storeHandler = storeHandler\r\n        return this.syncTo()\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {StoreHandler} storeHandler\r\n     */\r\n    fromStoreHandler(storeHandler) {\r\n        this.storeHandler = storeHandler\r\n        return this.syncFrom()\r\n    }\r\n\r\n    syncTo() {\r\n        if (this.storeHandler) {\r\n            this.storeHandler.setJson(this.storeHandlerKey, this.data)\r\n        }\r\n        return this\r\n    }\r\n\r\n    syncFrom() {\r\n        if (this.storeHandler) {\r\n            const data = this.storeHandler.getJson(this.storeHandlerKey)\r\n            data && (this.data = data)\r\n        }\r\n        return this\r\n    }\r\n\r\n    start() {\r\n        return this.sequenceStart()\r\n    }\r\n\r\n    sequenceStart() {\r\n        this.nextSequenceAccess = ++this.sequenceAccess + 1\r\n        return this\r\n    }\r\n\r\n    sequenceRestart() {\r\n        this.sequenceAccess = 1\r\n        this.nextSequenceAccess = 2\r\n        return this\r\n    }\r\n\r\n    sequenceSkip() {\r\n        this.nextSequenceAccess = this.sequenceAccess\r\n        return this\r\n    }\r\n\r\n    sequenceAbortSkipping() {\r\n        this.nextSequenceAccess = this.sequenceAccess + 1\r\n        return this\r\n    }\r\n\r\n    sequenceSkipping() {\r\n        return this.nextSequenceAccess <= this.sequenceAccess\r\n    }\r\n\r\n    isFreshSequence() {\r\n        return this.sequenceAccess === 1\r\n    }\r\n\r\n    isNotFreshSequence() {\r\n        return this.sequenceAccess > 1\r\n    }\r\n\r\n    flash(key, value) {\r\n        return this.store(key, value, true)\r\n    }\r\n\r\n    store(key, value, flash = false) {\r\n        this.data[key] = {\r\n            value: value,\r\n            flash: flash,\r\n        }\r\n        return this.syncTo()\r\n    }\r\n\r\n    retrieve(key, def = null) {\r\n        if (!(key in this.data)) return def\r\n\r\n        const data = this.data[key]\r\n        data.flash && this.forgot(key)\r\n        return data.value\r\n    }\r\n\r\n    forgot(key) {\r\n        delete this.data[key]\r\n        return this.syncTo()\r\n    }\r\n}\r\n"],"file":"session.js"}